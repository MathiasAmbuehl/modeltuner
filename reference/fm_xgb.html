<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='fm_xgb() is a convenience wrapper for tree boosting with
xgb.train() (from package xgboost)
that fits into the modeltuner framework.
The model is specified by the arguments formula and data.
The resulting models belong to the class of so-called iteratively fitted models,
see ifm and vignette("ifm") for information.'><title>formula-based wrapper for xgb.train() — fm_xgb • modeltuner</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="formula-based wrapper for xgb.train() — fm_xgb"><meta property="og:description" content='fm_xgb() is a convenience wrapper for tree boosting with
xgb.train() (from package xgboost)
that fits into the modeltuner framework.
The model is specified by the arguments formula and data.
The resulting models belong to the class of so-called iteratively fitted models,
see ifm and vignette("ifm") for information.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">modeltuner</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/modeltuner.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ifm.html">Fitting and tuning Iteratively Fitted Models</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1><code>formula</code>-based wrapper for <code>xgb.train()</code></h1>
      
      <div class="d-none name"><code>fm_xgb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>fm_xgb()</code> is a convenience wrapper for tree boosting with
<code><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html" class="external-link">xgb.train</a>()</code> (from package <a href="https://CRAN.R-project.org/package=xgboost" class="external-link"><span class="pkg">xgboost</span></a>)
that fits into the <code>modeltuner</code> framework.
The model is specified by the arguments <code>formula</code> and <code>data</code>.
The resulting models belong to the class of so-called <em>iteratively fitted models</em>,
see <code><a href="ifm.html">ifm</a></code> and <code><a href="../articles/ifm.html">vignette("ifm")</a></code> for information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fm_xgb</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  nrounds <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  early_stopping_rounds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.pass</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  monotone_constraints <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  interaction_constraints <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  obj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maximize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pref_iter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fm_xgb</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, abbreviate <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fm_xgb</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, pref_iter <span class="op">=</span> <span class="va">object</span><span class="op">$</span><span class="va">pref_iter</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">extract_booster</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>A <code>formula</code>.</p></dd>


<dt>data</dt>
<dd><p>A <code>data.frame</code>.</p></dd>


<dt>nrounds, early_stopping_rounds, obj, feval, maximize</dt>
<dd><p>Passed to <code>xgb.train</code>
(but note that some default values are different).</p></dd>


<dt>weights</dt>
<dd><p>Fitting weights.</p></dd>


<dt>na.action</dt>
<dd><p>A function which indicates what should happen when the data contain <code>NA</code>s.
<code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.pass</a></code> is the default, <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code>, <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></code> or <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail</a></code>
could be meaningful alternative settings.</p></dd>


<dt>verbose</dt>
<dd><p>Logical: Whether to print information on progress to console.</p></dd>


<dt>monotone_constraints</dt>
<dd><p>Named vector with values in <code>c(-1, 0, 1)</code>.
Names identify features, <code>1</code> means increasing, <code>-1</code> decreasing and <code>0</code> no constraint.
Features not appearing will be assigned a <code>0</code> in the call to <code>xgb.train()</code>.
Default is no constraints.</p></dd>


<dt>interaction_constraints</dt>
<dd><p>List of named character vectors defining interaction constraints. Default is no constraints.</p></dd>


<dt>pref_iter</dt>
<dd><p>An integer, the <em>preferred iteration</em>. This is the iteration that is used by default
when predictions from the model are computed with <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>.
If <code>pref_iter=NULL</code>, the <em>last</em> iteration will be used.
See <code><a href="ifm.html">ifm</a></code> and <code><a href="../articles/ifm.html">vignette("ifm")</a></code> for information on the concepts of
<em>iteratively fitted models</em> and preferred iterations.
The preferred iteration of a model can be changed without re-fitting the model,
see <code><a href="set_pref_iter.html">set_pref_iter</a>()</code>.</p></dd>


<dt>keep_x</dt>
<dd><p>Logical: Whether to keep the model matrix <code>x</code> as a component of the return value.</p></dd>


<dt>...</dt>
<dd><p>Passed to <code>params</code> in <code>xgb.train()</code>.</p></dd>


<dt>x, object</dt>
<dd><p>Object of class “fm_xgb”.</p></dd>


<dt>abbreviate</dt>
<dd><p>Logical. If <code>TRUE</code> (the default), long formulas and calls are printed in abbreviated mode,
such that they usually fit on 4 or fewer output lines; otherwise they are printed entirely, no matter how long they are.</p></dd>


<dt>newdata</dt>
<dd><p>Data for prediction.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>fm_xgb()</code> returns a list of class “fm_xgb” with components</p><ul><li><p><em>booster</em>: the xgboost booster, of class “xgb.Booster”;</p></li>
<li><p><em>formula</em>: the formula;</p></li>
<li><p><em>x</em>: the model matrix (resulting from the <code>formula</code> using <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code>);</p></li>
<li><p><em>weights</em>: the fitting weights;</p></li>
<li><p><em>xlevels</em>: list of the levels of the factors included in the model;</p></li>
<li><p><em>pref_iter</em>: the preferred iteration, an integer (see argument <code>pref_iter</code>);</p></li>
<li><p><em>na.action</em>: the <code><a href="https://rdrr.io/r/stats/na.action.html" class="external-link">na.action</a></code> used during data preparation;</p></li>
<li><p><em>contrasts</em>: the <code><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></code> used during data preparation;</p></li>
<li><p><em>call</em>: the matched call generating the model.</p></li>
</ul><p><code>extract_booster()</code> returns the booster, of class “xgb.Booster”.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Not all parameters of <code>xgb.train()</code> are available in <code>fm_xgb()</code>.
In particular, those related to console output (<code>verbose</code>, <code>print_every_n</code>),
those related to saving the result (<code>save_period</code>, <code>save_name</code>) and <code>callbacks</code>
won't be passed to <code>xgb.train()</code>.
The parameters <code>x</code> and <code>y</code> to be passed to <code>xgb.train()</code> are extracted from
<code>formula</code> and <code>data</code> by means of <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></code>, <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></code>
and <code><a href="https://rdrr.io/r/stats/model.extract.html" class="external-link">model.response</a></code>.</p>
<p><em>Features of cross-validation of models generated with</em> <code>fm_xgb()</code>:</p><ul><li><p>The model class “fm_xgb” belongs to the class of so-called
<em>iteratively fitted models</em>; see <a href="ifm.html">ifm</a> and <code>vifnette("ifm")</code> for information on
the peculiarities of cross-validating such models. In particular,
note the role of the parameter <code>iter</code> in <code><a href="cv.html">cv</a>()</code>.</p></li>
<li><p>When <code><a href="cv.html">cv()</a></code> is executed with <code>keep_fits=TRUE</code>, the fitted models from
cross-validation that are stored in the result (and returned by <code><a href="extract_fits.html">extract_fits</a>()</code>)
will not be of class “fm_xgb”, but of class “xgb.Booster”,</p></li>
</ul><p><em>Default metric:</em>
Currently, xgboost models generated with <code>fm_xgb()</code> are the only models not having the default choice
of its metric, <code>rmse</code> for continuous response and <code>logLoss</code> in the binary case.
Each xgboost model has an <code>eval_metric</code>.
If not specified explicitly by the user, this metric is automatically chosen depending on the <code>objective</code>
in the call to <code>xgb.train()</code> or <code>fm_xgb()</code>.
In <code>modeltuner</code>, when <code><a href="cv.html">cv()</a></code> is applied, the <code>eval_metric</code> is taken as the default metric
of the resulting "cv" object.
(see <code><a href="default_metric.html">default_metric</a>()</code>).</p>
<p><code>extract_booster()</code> returns the <em>booster</em>, an object of class “xgb.Booster”,
as returned by <code><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html" class="external-link">xgb.train</a>()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="methods-by-generic-">Methods (by generic)<a class="anchor" aria-label="anchor" href="#methods-by-generic-"></a></h2>
    
<ul><li><p><code>print(fm_xgb)</code>: <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method</p></li>
<li><p><code>predict(fm_xgb)</code>: <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html" class="external-link">xgb.train</a></code>, <code>xgb.cv</code> (package <a href="https://CRAN.R-project.org/package=xgboost" class="external-link"><span class="pkg">xgboost</span></a>);
<a href="ifm.html">ifm</a> and <code><a href="../articles/ifm.html">vignette("ifm")</a></code>; <code><a href="default_metric.html">default_metric</a></code>;
<code><a href="fit.html">fit.model_fm_xgb</a></code>; <code><a href="set_pref_iter.html">set_pref_iter</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># mtcars data</span></span></span>
<span class="r-in"><span><span class="va">xgb_cars</span> <span class="op">&lt;-</span> <span class="fu">fm_xgb</span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># predict</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">xgb_cars</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Mazda RX4     Mazda RX4 Wag        Datsun 710    Hornet 4 Drive </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          21.00058          20.99997          22.79976          21.39912 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout           Valiant </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          18.70015          18.10004 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># iris data</span></span></span>
<span class="r-in"><span><span class="va">xgb_iris</span> <span class="op">&lt;-</span> <span class="fu">fm_xgb</span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># cross-validate</span></span></span>
<span class="r-in"><span><span class="fu"><a href="cv.html">cv</a></span><span class="op">(</span><span class="va">xgb_iris</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- A “cv” object containing 1 validated model ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Validation procedure: Complete k-fold Cross-Validation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of obs in data:  150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of test sets:     10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Size of test sets:       15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Size of training sets:  135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘model’:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model class:  fm_xgb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   formula:      Sepal.Width ~ Sepal.Length + Petal.Length + Petal.Width + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Species - 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   metric:       rmse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Preferred iterations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model ‘model’:  min (iter=12)</span>
<span class="r-in"><span><span class="co"># Plot evaluation log</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="evaluation_log.html">evaluation_log</a></span><span class="op">(</span><span class="fu"><a href="last_cv.html">last_cv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fm_xgb-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mathias Ambuehl.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

